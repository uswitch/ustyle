// Loader
// ---
// It shows when added the class .us-loader--loading and it can center itself
// on the parent container if you add .us-loader--centered
//
// Styleguide 5.4

$loader-overlay-opacity: 0.8
$loader-overlay-colour: white
$spinner-vertical-margin: 1em
$spinner-animation-time: 500ms
$spinner-file: "icons/spinner.svg"
$spinner-white-file: "icons/spinner_white.svg"
$spinner-size: 60px
$spinner-file-fallback: "../images/icons/spinner_fallback.gif"
$spinner-load-fallback: false


+keyframes(loader-intro)
  from
    +opacity(0)

  to
    +opacity(1)

+keyframes(spin)
  from
    +rotate(0deg)

  to
    +rotate(360deg)


%snap-to-parent
  width: 100%
  height: 100%
  position: absolute
  top: 0
  left: 0

%spinner-dark
  background-image: inline-asset($spinner-file)
%spinner-white
  background-image: inline-asset($spinner-white-file)

%spinner
  z-index: 2
  position: relative
  display: inline-block
  margin-top: $spinner-vertical-margin
  margin-bottom: $spinner-vertical-margin
  background-repeat: no-repeat

  .us-loader--loading &
    +animation(spin, $spinner-animation-time, $iteration_count: infinite, $timing_function: linear)
    @extend %spinner-dark


= spinner($size: $spinner-size, $fallback: $spinner-load-fallback, $fallbackfile: $spinner-file-fallback)
  @extend %spinner

  @if $size
    background-size: $size
    width: $size
    height: $size

  @if $fallback
    .no-svg &
      +animation(none)
      background-image: url($spinner-file-fallback)

    .no-csstransitions &
      +animation(none)
      background-image: url($spinner-file-fallback)
  @else
    .no-svg &
      .us-loader__spinner
        display: none
    .no-csstransitions &
      .us-loader__spinner
        display: none

.us-loader
  @extend %snap-to-parent
  text-align: center
  display: none

.us-loader--loading
  display: block
  +animation(loader-intro, $spinner-animation-time)

.us-loader--centered
  @extend %vertical-align-parent
  +transform(preserve-3d)

.us-loader__inner
  position: relative
  z-index: 2

  .us-loader--centered &
    @extend %vertical-align-child

.us-loader__spinner
  +spinner(60px, true)

  .us-loader--centered &
    margin-top: 0

.us-loader__text
  @extend %heading-3
  color: $c-navy

.us-loader__overlay
  @extend %snap-to-parent
  background-color: $loader-overlay-colour
  +opacity($loader-overlay-opacity)
  z-index: 1

.us-loader__spinner--s
  +spinner(18px)
.us-loader__spinner--m
  +spinner(24px)
.us-loader__spinner--l
  +spinner(36px)
